<!DOCTYPE html>
<html>

<head>
  <title>Wait Conditions</title>
</head>


<body>


<div class="container align-items-center text-center">

  <!--
  ********************************************
  Set Min and Max waits
  ********************************************
  -->

  <br><br><br><br><br>

  <div class="card text-center shadow border-success">
    <div class="card-header justify-content-center">
      <h4>Set the <code>Min.</code> and <code>Max.</code> waits. It will be used as the waiting
        range by the sections below.
      </h4><br>
      <div class="row">
        <div class="col-sm-2"></div>
        <div class="col-sm-8">
          <form class="form-inline">
            <div class="input-group mr-1">
              <div class="input-group-prepend">
                <span class="input-group-text">Min. Wait</span>
              </div>
              <input class="form-control" id="min_wait" placeholder="Min. Wait" type="number" value="2">
              <div class="input-group-append">
                <span class="input-group-text">sec.</span>
              </div>
            </div>
            <div class="input-group mr-1">
              <div class="input-group-prepend">
                <span class="input-group-text">Max. Wait</span>
              </div>
              <input class="form-control" id="max_wait" placeholder="Max. Wait" type="number" value="5">
              <div class="input-group-append">
                <span class="input-group-text">sec.</span>
              </div>
            </div>
          </form>
        </div>
        <div class="col-sm-2"></div>
      </div>

    </div>
  </div>

  <br>


  <!--
  ********************************************
  Wait for alert to be present
  ********************************************
  -->
  <div class="card text-center shadow  border-success">
    <div class="card-header">
      <h3>Wait for alert to be present</h3>
    </div>
    <div class="card-body">
      <div class="row align-items-center text-center">
        <div class="col-sm-4">
          <p>Test the JavaScript <strong>alert</strong> and <strong>prompt</strong></p>
          <button class="btn btn-primary" id="alert_trigger" type="button">Show Alert</button>
          <button class="btn btn-primary" id="prompt_trigger" type="button">Show Prompt</button>
          <p></p>
        </div>
        <div class="col-sm-8">
          <h3 id="confirm_ok" style="display: none">Confirm response: <span
                  class="badge badge-success" id="confirm_ok_badge">OK</span></h3>
          <h3 id="confirm_cancelled" style="display: none">Confirm response: <span
                  class="badge badge-danger" id="confirm_cancelled_badge">Cancelled</span></h3>
          <h3 id="alert_handled" style="display: none"><span class="badge badge-success" id="alert_handled_badge">Alert
                                handled</span></h3>
        </div>
      </div>
    </div>
  </div>

  <br>

  <!--
  ********************************************
  Wait for element to be visible
  ********************************************
  -->
  <div class="card text-center shadow  border-success">
    <div class="card-header">
      <h3>Wait for element to be visible</h3>
    </div>
    <div class="card-body">
      <div class="row align-items-center text-center">
        <div class="col-sm-4">
          <p>Click the <strong>Trigger</strong> and an invisible button will be visible!</p>
          <button class="btn btn-primary" id="visibility_trigger" type="button">Trigger</button>
          <p></p>
        </div>
        <div class="col-sm-8">
          <p>A clickable button will appear here after <strong>Trigger</strong> button is clicked.</p>
          <button class="btn btn-danger" data-content="I just removed my invisibility cloak!!" data-toggle="popover" id="visibility_target"
                  style="display: none" title="Can you see me?"
                  type="button">Click Me
          </button>
        </div>
      </div>
    </div>
  </div>

  <br>

  <!--
  ********************************************
  Wait for element to be Invisible
  ********************************************
  -->
  <div class="card text-center shadow  border-success">
    <div class="card-header">
      <h3>Wait for element to be Invisible</h3>
    </div>
    <div class="card-body">
      <div class="row align-items-center text-center">
        <div class="col-sm-4">
          <p>Click the <strong>Trigger</strong> and the spinner will disappear!</p>
          <button class="btn btn-primary" id="invisibility_trigger" type="button">Trigger</button>
          <p></p>
        </div>
        <div class="col-sm-8">
          <p>This spinner will disappear after <strong>Trigger</strong> button is clicked.</p>
          <div class="spinner-border text-primary" id="invisibility_target" role="status">
            <span class="sr-only">Loading...</span>
          </div>
          <p id="spinner_gone" style="display: none">Thank God that spinner is gone!</p>
        </div>
      </div>
    </div>
  </div>

  <br>

  <!--
  ********************************************
  Wait for element to be enabled
  ********************************************
  -->
  <div class="card text-center shadow  border-success">
    <div class="card-header">
      <h3>Wait for element to be enabled / Wait for an attribute to contain certain text</h3>
    </div>
    <div class="card-body">
      <div class="row  align-items-center text-center">
        <div class="col-sm-4">
          <p>Click the <strong>Trigger</strong> and the <strong>Disabled Button</strong> will become
            active.</p>
          <button class="btn btn-primary" id="enabled_trigger" type="button">Trigger</button>
          <p></p>
        </div>
        <div class="col-sm-8">
          <p class="text-left">After the <strong>Trigger</strong> button is clicked, this button will be
            active <br>and the <em>class</em> attribute will be <em>"btn btn-success"</em>.
          </p>
          <button class="btn btn-danger" data-content="See, you just clicked me!!" data-toggle="popover" disabled
                  id="enabled_target" title="Yay! I am super active now!"
                  type="button">Disabled
            Button
          </button>
          <p></p>
        </div>
      </div>
    </div>
  </div>


  <br>

  <!--
  ********************************************
  Wait for Page Title to change
  ********************************************
  -->
  <div class="card text-center shadow  border-success">
    <div class="card-header">
      <h3>Wait for Page Title to change</h3>
    </div>
    <div class="card-body">
      <p>Click the <strong>Trigger</strong> and the Page Title will change to "My New Title!"</p>
      <button class="btn btn-primary" id="page_title_trigger" type="button">Trigger</button>
    </div>
  </div>

  <br>

  <!--
  ********************************************
  Wait for text/value to have specific values
  ********************************************
  -->
  <div class="card text-center shadow  border-success">
    <div class="card-header">
      <h3>Wait for text/value to have specific values</h3>
    </div>
    <div class="card-body">
      <div class="row align-items-center text-center">
        <div class="col-sm-6">
          <p>Click the <strong>Trigger</strong> to enter text in the textbox and change the button caption
          </p>
          <button class="btn btn-primary" id="text_value_trigger" type="button">Trigger</button>
          <p></p>
        </div>
        <div class="col-sm-6 align-items-center">
          <form class="form-inline">
            <input class="form-control" id="wait_for_value" placeholder="Creator of C" type="text">
            <button class="btn btn-success" id="wait_for_text" type="button">
              <span aria-hidden="true" class="spinner-grow spinner-grow-sm" role="status"></span>
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <br>

  <!--
  ********************************************
  Wait for frame to be available and then switch to it
  ********************************************
  -->
  <div class="card text-center shadow  border-success">
    <div class="card-header">
      <h3>Wait for frame to be available and then switch to it</h3>
    </div>
    <div class="card-body">
      <div class="row align-items-center text-center">
        <div class="col-sm-7">
          <p>Click the <strong>Trigger</strong> and a frame will appear after a few seconds</p>
          <button class="btn btn-primary" id="wait_for_frame" type="button">Trigger</button>
          <p></p>
        </div>
        <div class="col-sm-5 align-items-center">
          <p></p>
          <div class="embed-responsive embed-responsive-21by9 shadow" id="frame" style="display: none">
            <!--<iframe src="inner.html" name="frm" id="frm"></iframe>-->
          </div>
        </div>
      </div>
    </div>
  </div>

  <br>
</div>

<br><br><br><br>

<div id="any-page-mixin">
  <!-- Included content will be inserted here -->
</div>

<script>
  fetch('mixin/any_page_mixin.html')
           .then(response => response.text())
           .then(data => {
               document.getElementById('any-page-mixin').innerHTML = data;
           });
</script>

<script src="js/jquery-3.4.1.min.js" type="text/javascript"></script>
<script src="js/popper.min.js" type="text/javascript"></script>
<script src="js/bootstrap.min.js" type="text/javascript"></script>

<script>
  // sleep for "ms" milliseconds
  function sleep(ms) {
      return new Promise(resolve => setTimeout(resolve, ms * 1000));
  };

  // generate random number between the min and max values
  function randomSeconds() {
      var min = parseInt($("#min_wait").val());
      var max = parseInt($("#max_wait").val());

      return (Math.floor(Math.random() * (max - min)) + min);
  };

  // Put trigger button in waiting state
  function setWaitState(trigger, ms) {
      var origTarget = trigger.html();

      trigger
          .html('<span class="spinner-border spinner-border-sm mr-2" role="status" aria-hidden="true"></span> Waiting (' + ms + 's)')
          .attr("disabled", true);

      return origTarget;
  }

  // finish the wait state of the trigger button
  function finishWaitState(trigger, origHTML) {
      trigger.html(origHTML).attr("disabled", false);
  }

  // All functions
  $(document).ready(function () {
      // Initialize the popover
      $('[data-toggle="popover"]').popover();

      // wait for element visible
      $("#visibility_trigger").click(async function () {
          var ms = randomSeconds();
          origTarget = setWaitState($(this), ms);
          console.log("wait = " + ms);
          await sleep(ms);

          $("#visibility_target").show();

          finishWaitState($(this), origTarget);
      });

      // wait for element invisible
      $("#invisibility_trigger").click(async function () {
          var ms = randomSeconds();
          origTarget = setWaitState($(this), ms);
          console.log("wait = " + ms);
          await sleep(ms);

          $("#invisibility_target").hide();
          $("#spinner_gone").show();

          finishWaitState($(this), origTarget);
      });

      // wait for element enabled
      $("#enabled_trigger").click(async function () {
          var ms = randomSeconds();
          origTarget = setWaitState($(this), ms);
          console.log("wait = " + ms);
          await sleep(ms);

          $("#enabled_target")
              .attr("class", "btn btn-success")
              .html("Enabled Button")
              .attr("disabled", false);

          finishWaitState($(this), origTarget);
      });

      // wait for alert
      $("#alert_trigger").click(async function () {
          $("#confirm_cancelled").hide();
          $("#confirm_ok").hide();
          $("#alert_handled").hide();

          var ms = randomSeconds();
          origTarget = setWaitState($(this), ms);
          console.log("wait = " + ms);
          await sleep(ms);

          a = alert("I am alerting you!");
          $("#alert_handled").show();

          finishWaitState($(this), origTarget);
      });

      // wait for confirm
      $("#prompt_trigger").click(async function () {
          $("#confirm_cancelled").hide();
          $("#confirm_ok").hide();
          $("#alert_handled").hide();

          var ms = randomSeconds();
          origTarget = setWaitState($(this), ms);
          console.log("wait = " + ms);
          await sleep(ms);

          res = confirm("Choose wisely...\nIt's your life!");
          if (res) {
              $("#confirm_ok").show();
          } else {
              $("#confirm_cancelled").show();
          }

          finishWaitState($(this), origTarget);
      });

      // Wait for Page Title to change
      $("#page_title_trigger").click(async function () {
          var ms = randomSeconds();
          origTarget = setWaitState($(this), ms);
          console.log("wait = " + ms);
          await sleep(ms);

          $(document).attr("title", "My New Title!");

          finishWaitState($(this), origTarget);
      });

      // Wait for text/value to have specific values
      $("#text_value_trigger").click(async function () {
          var ms = randomSeconds();
          origTarget = setWaitState($(this), ms);
          console.log("wait = " + ms);
          await sleep(ms);

          $("#wait_for_value").val("Dennis Ritchie");
          $("#wait_for_text").html("Submit");

          finishWaitState($(this), origTarget);
      });

      // wait for frame visible
      $("#wait_for_frame").click(async function () {
          var ms = randomSeconds();
          origTarget = setWaitState($(this), ms);
          console.log("wait = " + ms);
          await sleep(ms);

          $("#frame")
              .html('<iframe src="inner.html" name="frm" id="frm"></iframe>')
              .show();
          //$('#frm').attr("src", $('#frm').attr("src"));
          //document.getElementById("frm").contentDocument.location.reload(true);

          finishWaitState($(this), origTarget);
      });
  });
</script>
</body>

</html>
